<div class="contextual-risk-chart-container">
	<h3 class="contextual-risk-title">Contextual Risk</h3>
	<div class="risk-summary">
		<div class="risk-stats">
			@for (stat of riskStats; track stat.level) {
				<div class="risk-stat">
					<span class="risk-count" [ngClass]="stat.color">
						<p class="risk-count-number">{{ stat.count }}</p>
						<p class="risk-count-level">{{ stat.level }}</p>
					</span>
				</div>
			}
		</div>

		<div class="chart">
			<svg [attr.viewBox]="'0 0 ' + chartViewBoxSize + ' ' + chartViewBoxSize" class="donut">
				<g [attr.transform]="'rotate(-90 ' + chartCenter + ' ' + chartCenter + ')'">
					@for (segment of segments; track segment.colorClass) {
						<circle
							class="segment"
							[ngClass]="segment.colorClass"
							[attr.cx]="chartCenter"
							[attr.cy]="chartCenter"
							[attr.r]="chartRadius"
							[attr.stroke-dasharray]="segment.percent + ' ' + (100 - segment.percent)"
							[attr.stroke-dashoffset]="100 - segment.offset"
						/>
					}
				</g>

				<text
					[attr.x]="chartCenter"
					[attr.y]="chartTextY"
					class="value"
					text-anchor="middle"
					dominant-baseline="middle"
				>
					{{ total }}
				</text>
			</svg>
		</div>
	</div>
</div>
